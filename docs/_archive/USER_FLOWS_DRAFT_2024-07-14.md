# ⚠️ УСТАРЕВШИЙ ДОКУМЕНТ

> Актуальная схема ролей и статусов пользователя — см. [docs/USER_ROLES.md](../USER_ROLES.md)

---

# Краткий user journey CabrioRide

Этот раздел описывает сквозной путь пользователя по приложению CabrioRide — от первого входа до получения полного доступа и взаимодействия с основными разделами. Для подробностей по каждому этапу см. ссылки на соответствующие разделы документации.

1. **Первый вход**
   - Пользователь заходит через Telegram-бот и WebApp.
   - [Подробнее: Первый вход](#первый-вход)

2. **Добавление автомобиля или выбор "я без авто"**
   - Без этого шага нельзя продолжить работу.
   - [Подробнее: Первый вход, шаг 4](#первый-вход)

3. **Заполнение профиля**
   - Пользователь попадает в раздел "Профиль" (или может перейти туда через кнопку в хедере).
   - Заполняет анкету, видит прогрессбар и подсказки.
   - [Подробнее: Прогресс заполнения профиля пользователя](#прогресс-заполнения-профиля-пользователя)

4. **Отправка профиля на модерацию**
   - Кнопка "Отправить на модерацию" становится активной при заполнении >50% анкеты.
   - После отправки — статус "pending", сообщение "Ваш профиль отправлен на модерацию." 
   - [Подробнее: Первый вход, шаг 4 и 2️⃣ Активация пользователя](#первый-вход)

5. **Модерация**
   - Модератор проверяет профиль, при необходимости связывается с пользователем.
   - После подтверждения — статус "active", роль "user".
   - [Подробнее: 2️⃣ Активация пользователя](#2️⃣-активация-пользователя)

6. **Доступ к основным разделам**
   - После активации доступны все основные разделы: участники, машины, карта, события, гид.
   - [Подробнее: APP_SECTIONS.md](APP_SECTIONS.md)

7. **Редактирование профиля**
   - Доступно всегда (через кнопку в хедере или иконку-карандаш в профиле).
   - После редактирования статус снова становится "pending" до повторной модерации.
   - [Подробнее: Прогресс заполнения профиля пользователя](#прогресс-заполнения-профиля-пользователя)

8. **Навигация**
   - Нижнее меню: участники, машины, карта, события, гид.
   - Верхний хедер: слева — дашборд, по центру — титул раздела, справа — профиль.
   - [Подробнее: APP_SECTIONS.md](APP_SECTIONS.md)

9. **Система respect и другие функции**
   - В чужом профиле — кнопка "respect" (система развесовки пользователей).
   - [Подробнее: будет описано отдельно]

---

# Прогресс заполнения профиля пользователя

В CabrioRide реализована система прогресса заполнения профиля, основанная на индивидуальных вопросах анкеты. Каждый вопрос имеет свой вес (процент), и общий прогресс отображается пользователю в виде прогрессбара. Для отправки профиля на модерацию (статус pending) требуется заполнить более 50% анкеты.

## Сетка вопросов и их вклад в прогресс

| №  | Вопрос/Поле                      | Ключ в БД/форме         | Вес (процент) |
|----|----------------------------------|-------------------------|---------------|
| 1  | Имя (в приложении)               | first_name_app          | 10%           |
| 2  | Фамилия (в приложении)           | last_name_app           | 10%           |
| 3  | Город                            | city                    | 7%            |
| 4  | Страна                           | country                 | 7%            |
| 5  | Фото (аватар)                    | avatar (photos)         | 7%            |
| 6  | Email                            | email                   | 7%            |
| 7  | Телефон                          | phone                   | 7%            |
| 8  | О себе (коротко)                 | about                   | 7%            |
| 9  | Username Telegram                | username                | 7%            |
| 10 | Instagram                        | instagram               | 7%            |
| 11 | Дата рождения                    | birth_date              | 10%           |
| 12 | **Добавлен хотя бы один автомобиль** (если have_auto = true, cars/link_user_cars) **ИЛИ** выбран "С кем катаетесь" (если have_auto = false, host_user_id) | cars/link_user_cars **или** host_user_id | 14% |
|    | **Итого**                        |                         | **100%**      |

- Если у пользователя есть автомобиль (have_auto = true), обязательным для прогресса является добавление хотя бы одного автомобиля.
- Если у пользователя нет автомобиля (have_auto = false), обязательным для прогресса является выбор "С кем катаетесь" (host_user_id).
- Для перехода в статус pending требуется заполнить более 50% анкеты (например, любые вопросы, сумма весов которых превышает 50%).
- Прогрессбар и процент заполнения отображаются на странице профиля и/или в анкете.
- Кнопка "Отправить на модерацию" становится активной только при достижении нужного процента.
- Под незаполненными вопросами отображаются подсказки.

---

# Подробный путь пользователя (user flow)

1. **Первый вход**
   - Пользователь заходит в приложение через Telegram-бот и WebApp.
   - Если пользователь новый, создаётся запись в базе, фиксируются данные Telegram.
   - [Подробнее: Первый вход](#первый-вход)

2. **Добавление автомобиля или выбор "я без авто"**
   - Пользователь видит окно с формой добавления автомобиля или кнопку "Я без авто".
   - Без этого шага нельзя продолжить работу с приложением.
   - После выбора статус становится "registered".
   - [Подробнее: Первый вход, шаг 4](#первый-вход)

3. **Заполнение профиля**
   - Пользователь автоматически попадает в раздел "Профиль".
   - В профиле отображаются все вопросы анкеты, прогрессбар заполнения и подсказки по незаполненным полям.
   - Кнопка "Отправить на модерацию" неактивна, пока заполнено менее 50% анкеты (по весам вопросов).
   - [Подробнее: Прогресс заполнения профиля пользователя](#прогресс-заполнения-профиля-пользователя)

4. **Отправка профиля на модерацию**
   - После заполнения анкеты более чем на 50% пользователь может отправить профиль на модерацию.
   - После отправки появляется сообщение: "Ваш профиль отправлен на модерацию." Статус меняется на "pending".
   - [Подробнее: Первый вход, шаг 4 и 2️⃣ Активация пользователя](#первый-вход)

5. **Модерация**
   - Модератор проверяет профиль, при необходимости связывается с пользователем.
   - После подтверждения статус меняется на "active", роль становится "user".
   - [Подробнее: 2️⃣ Активация пользователя](#2️⃣-активация-пользователя)

6. **Доступ к основным разделам**
   - После активации доступны все основные разделы: участники, машины, карта, события, гид.
   - [Подробнее: APP_SECTIONS.md](APP_SECTIONS.md)

7. **Редактирование профиля**
   - Пользователь всегда может редактировать свой профиль (через кнопку в хедере или иконку-карандаш в профиле из списка участников).
   - Если профиль был "active" и был отредактирован, статус снова становится "pending" до повторной модерации.
   - [Подробнее: Прогресс заполнения профиля пользователя](#прогресс-заполнения-профиля-пользователя)

8. **Навигация**
   - Нижнее меню: участники, машины, карта, события, гид.
   - Верхний хедер: слева — дашборд, по центру — титул раздела, справа — профиль.
   - [Подробнее: APP_SECTIONS.md](APP_SECTIONS.md)

9. **Система respect и другие функции**
   - В чужом профиле отображается кнопка "respect" (система развесовки пользователей).
   - [Подробнее: будет описано отдельно]

---

## Статусы пользователей и сущностей

- **active** — активный
- **pending** — на модерации
- **registered** — зарегистрирован
- **blocked** — заблокирован
- **deleted** — удалён (присваивается при удалении сущности, физически не удаляется из базы)

> При удалении любой сущности (автомобиля, события и др.) статус меняется на 'удалён', а сама запись остаётся в базе для истории и аудита.

---

## 📋 Список сценариев

0. Первый вход
1. Регистрация пользователя (см. Первый вход)
2. Активация пользователя (см. раздел выше)
3. Добавление и управление автомобилями
4. Добавление и управление событиями
5. Добавление визитки (приглашение нового участника) — TODO
6. Оставление отзыва об объекте
7. Участие в событии (мероприятии)
8. Добавление и управление объектами (гид)
9. Авторизация и вход через Telegram — TODO
10. Выход из клуба (деактивация) — TODO
11. Работа с Telegram-ботом (уведомления, поиск, WebApp) — TODO
12. Управление профилем и настройками — TODO
13. Использование раздела "Карта" — TODO
14. Поиск автомобиля по фото/номеру — TODO
15. Система respect — TODO

---

## Первый вход

**Пошаговое описание процесса:**

1. Пользователь впервые заходит в Telegram-бот и переходит в WebApp.
2. Система проверяет, есть ли пользователь в базе:
   - Если нет — создаёт запись в таблице пользователей, фиксируя Telegram ID, никнейм, имя, фамилию, фото.
   - Если уже есть в базе:
     - Если статус "зарегистрирован" (registered) — пользователь попадает в профиль для заполнения анкеты (см. [Прогресс заполнения профиля пользователя](#прогресс-заполнения-профиля-пользователя)).
     - Если статус "active" — полный доступ ко всем разделам (см. [User Journey](#user-journey)).
     - Если статус "pending" — сообщение "Профиль на модерации", ограниченный доступ.
     - Если статус "blocked", "left", "external" — показывается соответствующая заглушка (см. [Статусы пользователей и сущностей](#статусы-пользователей-и-сущностей)).
3. У пользователя статус "новый". Пока статус "новый", он видит только начальное окно приветствия.
4. Окно приветствия:
   - Краткое приветствие и пояснение о необходимости добавить авто или отметить, что он без авто.
   - **Форма добавления автомобиля:**
     - *Фото автомобиля* (обязательное поле)
     - *Марка и модель* (выбор из выпадающего списка, данные из справочника в БД)
     - *Регистрационный номер* (обязательное поле, с пояснением: "нужен для определения клубных и неклубных авто")
     - Галочка "Скрыть номер" (по умолчанию выключена, пояснение: "если включить — номер будет скрыт от участников в интерфейсе")
     - Кнопка "Добавить авто"
   - **Блок для тех, у кого нет авто:**
     - Краткое пояснение ("Если у вас нет авто — нажмите сюда")
     - Кнопка "Я без авто"
5. Пользователь не может закрыть это окно, пока не выберет один из вариантов.
6. Если пользователь добавляет авто:
   - Проверяется заполненность обязательных полей.
   - Если всё заполнено — авто добавляется в профиль пользователя.
   - В БД у пользователя устанавливается have_auto = true.
   - Статус пользователя меняется на "зарегистрирован".
   - Пользователь попадает в свой профиль, где видит минимально заполненный профиль и добавленный авто.
7. Если пользователь нажимает "Я без авто":
   - У пользователя в БД устанавливается have_auto = false.
   - Статус меняется на "зарегистрирован".
   - Пользователь попадает в свой профиль (без авто).
8. После смены статуса с "новый" на "зарегистрирован" пользователь получает доступ к остальным разделам приложения.

### Edge-cases:
- Если Telegram API недоступен или не удаётся получить данные пользователя — показывается сообщение об ошибке и просьба попробовать позже.
- Если пользователь уже зарегистрирован, но пытается войти повторно — происходит обновление данных Telegram, дубли не создаются.
- Если пользователь не выбрал ни один вариант (авто или "я без авто") — окно приветствия нельзя закрыть, дальнейшие действия заблокированы.
- Если в будущем появится лимит на количество регистраций с одного Telegram-аккаунта — параметр будет вынесен в config/app.config.ts (0 = нет ограничения).

---

## 1️⃣ Регистрация пользователя

_Регистрация пользователя происходит автоматически при первом входе через Telegram-бот и WebApp. Все шаги, поля и UX подробно описаны в сценарии "Первый вход"._

---

## 2️⃣ Активация пользователя

**Пошаговое описание процесса:**

1. **Профиль пользователя отправлен на модерацию**  
   — Статус: pending.  
   — Пользователь видит сообщение: «Ваш профиль отправлен на модерацию» (уведомление приходит через Telegram-бот).

2. **Модератор открывает профиль ( подробную карточку ) пользователя в списке**  
   — В списке пользователей со статусом pending отображается кнопка «Активировать» и «Отклонить».  
   — Модератор видит прогресс заполнения профиля (прогрессбар), все введённые данные, а также обязательные поля:
     - Имя (first_name_app)
     - Автомобиль (если have_auto = true) или выбранный владелец (если have_auto = false)
     - Общий прогресс >50%

3. **Проверка данных**  
   — Модератор убеждается, что:
     - Нет фейковых/некорректных данных.
     - Заполнены все обязательные поля.
     - При необходимости связывается с пользователем через Telegram.

4. **Активация профиля**  
   — Если всё корректно, модератор нажимает «Активировать».
   — Статус пользователя меняется на «active».
   — Роль становится «user».
   — Пользователь получает уведомление через Telegram-бот: «Ваш профиль активирован!».
   — Действие модератора логируется (см. ниже).

5. **Отклонение профиля**  
   — Если профиль заполнен некорректно или не полностью:
     - Модератор нажимает «Отклонить», указывает причину (обязательное поле).
     - Статус возвращается на «registered».
     - Пользователь получает уведомление через Telegram-бот с причиной отклонения.
     - Действие модератора логируется (см. ниже).

6. **Повторная модерация**  
   — Если пользователь редактирует профиль после активации, статус снова становится «pending».
   — Процесс повторяется.

**Edge-cases:**
- Если профиль был активирован ошибочно — модератор может вручную перевести статус обратно в «pending» или «registered» (с указанием причины, действие также логируется).
- Если пользователь не реагирует на замечания модератора — профиль может быть временно заблокирован (описать отдельно).

**Логирование действий модератора:**
- Все действия модератора (активация, отклонение, причина, время, кто модерировал) обязательно логируются для истории.
- Для этого потребуется отдельная таблица логов модерации (будет описана и добавлена в схему БД отдельно).

**Уведомления:**
- Все системные уведомления (активация, отклонение, комментарии модератора и т.д.) отправляются пользователю только через Telegram-бот.
- В уведомлении всегда указывается причина (если профиль отклонён) и статус.

---

## 3️⃣ Добавление и управление автомобилями

**Пошаговое описание процесса:**

1. **Переход в раздел "Авто"**
   - Пользователь открывает раздел "Авто" в приложении.
   - В правом нижнем углу экрана отображается плавающая кнопка "+" (FAB), предназначенная для добавления нового автомобиля.

2. **Добавление автомобиля**
   - При нажатии на "+" открывается форма для добавления автомобиля:
     - Фото автомобиля (обязательное)
     - Марка и модель (выбор из справочника, обязательное)
     - Регистрационный номер (обязательное)
     - Чекбокс "Скрыть номер" (по умолчанию выключен)
   - Пользователь заполняет все обязательные поля и нажимает "Сохранить".
   - После успешного добавления:
     - Автомобиль появляется в списке авто пользователя.
     - Если это первый авто, у пользователя флаг have_auto становится true.
     - Прогресс заполнения профиля пересчитывается.
     - Пользователь получает уведомление через Telegram-бот: «Автомобиль успешно добавлен».

3. **Просмотр и управление своими автомобилями**
   - В списке авто отображаются все автомобили пользователя.
   - При нажатии на автомобиль открывается подробная карточка этого авто.
   - В подробной карточке доступны кнопки «Редактировать» и «Удалить» (только для своих авто).
     - При нажатии «Редактировать» поля становятся доступными для изменения, а кнопка меняется на «Сохранить».
     - После сохранения изменений пользователь получает уведомление через Telegram-бот.
     - Кнопка «Удалить» позволяет удалить авто (если политика клуба разрешает).

4. **Edge-cases**
   - Если пользователь удаляет последний авто, флаг have_auto становится false, и пользователю предлагается выбрать «С кем катаетесь».
   - Если достигнут лимит по количеству авто — кнопка "+" становится неактивной, появляется подсказка.
   - Все ошибки и успешные действия сопровождаются уведомлениями через Telegram-бот.

**UX-детали:**
- Кнопка "+" (FAB) всегда видна в правом нижнем углу раздела "Авто", поверх основного интерфейса.
- Редактирование и удаление доступны только для своих автомобилей и только из подробной карточки.
- После добавления/редактирования/удаления авто пользователь остаётся в разделе "Авто" и видит актуальный список.

---

## 4️⃣ Добавление и управление событиями

**Пошаговое описание процесса:**

1. **Переход в раздел "События"**
   - Пользователь открывает раздел "События" в приложении.
   - В правом нижнем углу экрана отображается плавающая кнопка "+" (FAB), предназначенная для добавления нового события.

2. **Добавление события**
   - При нажатии на "+" открывается форма для добавления события.
   - Форма содержит следующие поля:
     - Название события (обязательное)
     - Дата и время (обязательное, выбор через календарь/таймпикер)
     - Место проведения (обязательное, можно выбрать на карте или ввести вручную)
     - Описание (опционально)
     - Фото/обложка события (опционально)
     - Лимит участников (опционально)
     - Чекбокс "Сделать событие приватным" (опционально)
   - Пользователь заполняет обязательные поля и нажимает "Сохранить".

3. **Валидация и сохранение**
   - Все обязательные поля проходят валидацию (например, дата не в прошлом, название не пустое).
   - После успешного сохранения событие появляется в списке событий.
   - Пользователь получает уведомление через Telegram-бот: «Событие успешно добавлено».

4. **Просмотр и управление своими событиями**
   - В списке событий отображаются все доступные мероприятия.
   - При нажатии на событие открывается подробная карточка события.
   - Если пользователь — организатор события, в карточке доступны кнопки «Редактировать» и «Удалить».
     - При нажатии «Редактировать» поля становятся доступными для изменения, а кнопка меняется на «Сохранить».
     - После сохранения изменений пользователь получает уведомление через Telegram-бот.
     - Кнопка «Удалить» меняет статус события на 'удалён' (событие не удаляется физически из базы, а помечается как удалённое).
     - Аналогичная логика применяется для автомобилей и других сущностей.

5. **Edge-cases**
   - Если пользователь пытается создать событие с некорректными данными (например, дата в прошлом) — появляется подсказка.
   - Если достигнут лимит на количество создаваемых событий — кнопка "+" становится неактивной, появляется подсказка.
   - Все ошибки и успешные действия сопровождаются уведомлениями через Telegram-бот.
   - При удалении любой сущности (события, авто и др.) статус меняется на 'удалён', а не происходит физическое удаление.

**UX-детали:**
- Кнопка "+" (FAB) всегда видна в правом нижнем углу раздела "События", поверх основного интерфейса.
- Редактирование и удаление доступны только для своих событий и только из подробной карточки.
- После добавления/редактирования/удаления события пользователь остаётся в разделе "События" и видит актуальный список.

---

## 5️⃣ Добавление визитки (приглашение нового участника через приложение)

**Кратко:**
Активный пользователь может оставить визитку (приглашение в клуб) на автомобиле, который не найден в базе CabrioRide. Визитку можно оставить через приложение, используя фото или номер авто. После проверки наличия авто в клубе, пользователь может заполнить и отправить визитку, которая фиксируется в базе.

### Пошаговый сценарий:

1. **Доступ к функции**
   - На дашборде (стартовом) экране приложения есть кнопка «Проверить авто / визитки».
   - Доступна только активным пользователям.

2. **Выбор способа поиска**
   - Открывается форма с двумя вариантами:
     - Загрузить фото автомобиля
     - Ввести номер автомобиля (только латинские буквы и цифры, валидация на ввод)

3. **Проверка по фото**
   - Пользователь загружает фото авто.
   - Фото отправляется на backend-эндпоинт для распознавания номера.
   - В ответе:
     - Если номер найден в базе — показывается номер и его статус (active, deleted, left и др.).
     - Если не найден — показывается номер и сообщение «такого номера нет в клубе».

4. **Проверка по номеру (текст)**
   - Пользователь вводит номер (только латиница и цифры, остальные символы автоматически не вводятся. для отправки минимум 3 символа).
   - Поиск по частичному совпадению:
     - Если есть хотя бы одно совпадение — сообщение «Совпадения есть».
     - Если совпадений нет — сообщение «Совпадений нет».
     - Если номер совпал полностью — показывается номер и его статус (как при фото).

5. **Лимит проверок**
   - На одного пользователя — не более 6 проверок в сутки (лимит хранится в config/app.config.ts, 0 = без ограничений).
   - При превышении лимита — сообщение «Достигнут лимит проверок на сегодня».

6. **Оставить визитку**
   - После любой проверки (независимо от результата) появляется вопрос: «Хотите оставить визитку?» (Да/Нет).
   - Если «Нет» — возврат к поиску авто (пользователь может искать другой номер).
   - Если «Да» —
     - **Если авто найдено в базе:**
       - Сразу создаётся запись в таблице визиток, привязанная к существующей машине (новая машина не создаётся).
     - **Если авто не найдено:**
       - Сразу создаётся новая машина (по введённым/распознанным данным, без хозяина) и запись в таблице визиток, привязанная к этой машине.
   - Для проверки авто достаточно ввести минимум 3 символа в поле номера.
   - Для отправки визитки номер должен содержать минимум 6 символов.
   - После успешной отправки — сообщение «Визитка зафиксирована!» и возврат на дашборд.

### Edge-cases:
- Если данных недостаточно (например, не распознан номер или не загружено фото, либо номер короче 6 символов для визитки) — показываем ошибку и просим повторить попытку.
- Если лимит проверок исчерпан — функция недоступна до следующего дня.
- Если пользователь не активен — функция недоступна.

### UX-детали:
- Для поиска авто достаточно 3 символов в поле номера, для отправки визитки — минимум 6 символов.
- Всё максимально быстро: поиск → вопрос → запись визитки (и при необходимости машины) → уведомление → дашборд.
- Кнопка «Оставить визитку» активна только при заполнении обязательных полей (фото и номер, номер не короче 6 символов).

### Лимиты/ограничения:
- Только для активных пользователей
- 6 проверок в сутки (config/app.config.ts)
- Фото и номер — обязательные для визитки

### Связанные статусы/роли:
- Пользователь: только со статусом active
- Авто: любой статус (active, deleted, left и др.)

### Ссылки на другие документы:
- [API: /api/ocr, /api/plate-search](API_METHODS.md)
- [Конфиг лимитов](../config/app.config.ts)
- [Структура таблиц машин и визиток](DATABASE_SCHEMA.md)
- [Работа с Telegram-ботом](#1️⃣-работа-с-telegram-ботом-start-проверка-авто-вход-в-приложение)

---

## 6️⃣ Оставление отзыва об объекте

**Пошаговое описание процесса:**

1. **Кто может оставить отзыв**
   - Оставить отзыв об объекте может любой активный участник клуба.

2. **Способы попасть в форму отзыва**
   - После добавления нового объекта ("Сохранить и оставить отзыв").
   - В разделе "Гид" — из подробной карточки по кнопке "Оставить отзыв".

3. **Форма отзыва**
   - Название объекта подставлено автоматически.
   - Три слайдера (10-бальная шкала, значения от 1 до 10, по умолчанию — 5):
     - **Качество:** слева "плохо" (красный), справа "отлично" (зелёный), градиент от красного к зелёному. Значение отображается числом над бегунком.
     - **Скорость:** слева "медленно" (красный), справа "быстро" (зелёный), градиент от красного к зелёному. Значение отображается числом над бегунком.
     - **Цена:** слева "низкая" (зелёный), справа "высокая" (красный), градиент от зелёного к красному. Значение отображается числом над бегунком. Для расчёта оценки используется формула: **оценка цены = 11 - price_rating**.
   - Ниже — поле для текстового отзыва (обязательное).
   - Поле для загрузки фото (опционально).
   - Под слайдерами и перед кнопкой "Добавить" отображаются:
     - **Средний балл = (quality_rating + speed_rating + (оценка цены)) / 3**
     - **Показатель "цена/качество" = (оценка цены) / ((quality_rating + speed_rating) / 2)**
       - Все три показателя (качество, скорость, оценка цены) имеют диапазон 1–10.
       - Чем выше этот показатель, тем выгоднее объект по соотношению цена/качество.
   - Кнопка "Добавить".

4. **Сохранение отзыва**
   - После заполнения всех полей и нажатия "Добавить" отзыв сохраняется в базе.
   - Пользователь получает уведомление через Telegram-бот: «Ваш отзыв успешно добавлен».
   - Отзыв сразу становится видимым в карточке объекта (модерация не требуется).

5. **Управление отзывом**
   - Редактировать и удалить отзыв может только его автор.
   - После редактирования или удаления пользователь получает соответствующее уведомление через Telegram-бот.

6. **Edge-cases**
   - Если пользователь уже оставлял отзыв для этого объекта — появляется предупреждение, повторное добавление невозможно (разрешено только редактирование/удаление своего отзыва).
   - Все ошибки и успешные действия сопровождаются уведомлениями через Telegram-бот.

**UX-детали:**
- Слайдеры по умолчанию стоят по центру (значение 5).
- Градиенты:
  - Качество — от красного к зелёному (слева направо).
  - Скорость — от красного к зелёному (слева направо).
  - Цена — от зелёного к красному (слева направо).
- Подписи слева/справа:
  - Качество: "плохо" / "отлично"
  - Скорость: "медленно" / "быстро"
  - Цена: "низкая" / "высокая"
- Значение каждого слайдера отображается числом над бегунком. Для цены — по формуле: **оценка цены = 11 - price_rating**.
- Средний балл и показатель "цена/качество" обновляются в реальном времени при изменении любого слайдера и видны пользователю рядом с кнопкой "Добавить".

---

## 6️⃣ Участие в событии (мероприятии)

**Пошаговое описание процесса:**

1. **Просмотр списка событий**
   - Пользователь открывает раздел "События".
   - В списке отображаются все актуальные мероприятия.
   - На мини-карточке события пользователь видит свою отметку-статус (например, "Да", "Возможно", "Нет"), если уже ответил.

2. **Открытие подробной карточки события**
   - При нажатии на событие открывается подробная карточка с описанием, датой, временем, местом, организатором, списком участников, фото и т.д.
   - В карточке события отображается предложение принять участие и три кнопки: "Да", "Возможно", "Нет".

3. **Выбор статуса участия**
   - Пользователь выбирает один из вариантов:
     - **Да** — участвует
     - **Возможно** — не уверен
     - **Нет** — не участвует
   - После выбора статус сохраняется, пользователь получает уведомление через Telegram-бот.
   - Пользователь может изменить свой ответ в любой момент (ответы можно менять неограниченно).
   - При изменении ответа организатор события получает уведомление через Telegram-бот о смене статуса участником.

4. **Список участников**
   - В карточке события отображается список участников по категориям:
     - Затем все, кто выбрал "Да" (участвуют)
     - Затем все, кто выбрал "Возможно"
     - В конце — все, кто выбрал "Нет"
   - В каждой категории участники отображаются с аватарками и именами.
   - Организатор подсвечивается 

5. **Edge-cases**
   - Если событие уже началось или завершено — изменить ответ нельзя, кнопки становятся неактивными.
   - Если пользователь заблокирован или не имеет доступа — кнопки недоступны, отображается причина.

**UX-детали:**
- Все действия сопровождаются уведомлениями через Telegram-бот.
- В карточке события всегда виден статус пользователя и его можно изменить.
- В списке событий на мини-карточке всегда отображается текущий ответ пользователя.
- Модерация участия не требуется, все статусы фиксируются автоматически.

---


## 1️⃣2️⃣ Использование раздела "Карта"

_Пошаговое описание процесса:_

1. Пользователь открывает раздел "Карта" в приложении.
2. Система запрашивает разрешение на использование геолокации.
3. Если пользователь разрешает — его координаты отправляются на сервер каждые 10 секунд.
4. На карте отображаются все участники с актуальными координатами (обновлены не более 20 минут назад).
5. На аватарке каждого участника отображается цветной индикатор статуса (зелёный, оранжевый, серый).
6. Если пользователь не дал разрешение — карта скрывается через 20 секунд, и остаётся уведомление, что для просмотра карты нужно разрешить использование координат. По умолчанию карта центрируется на Минске (Беларусь).
7. После разрешения передачи координат появляется переключатель "Показывать меня на карте" — пользователь может в любой момент отключить передачу координат.
8. Если пользователь отключает передачу координат, карта исчезает через 20 секунд с плавным переходом: сначала становится чёрно-белой, затем прозрачной, затем появляется уведомление, как снова включить отображение.
9. Доступ к разделу ограничен по ролям/статусам. 

## 1️⃣3️⃣ Отправка и получение голосового сообщения на карте

_Пошаговое описание процесса:_

1. Пользователь нажимает и удерживает кнопку микрофона на карте.
2. Записывает голосовое сообщение (до 30 сек).
3. Отпускает кнопку — сообщение отправляется на сервер.
4. Все активные на карте получают уведомление и сообщение автоматически воспроизводится (если пользователь не записывает своё сообщение).
5. Если пользователь занят записью, входящие сообщения становятся в очередь и воспроизводятся после завершения записи.
6. Пользователь может открыть список последних сообщений и прослушать любое из них вручную.
7. Сообщения автоматически удаляются через 1 час. 

## 1️⃣4️⃣ Добавление и удаление подсказки на карте

_Пошаговое описание процесса:_

1. Пользователь нажимает кнопку "Добавить подсказку" на карте.
2. Выбирает тип подсказки ("ГАИ", "ремонт", "пробка", "авария").
3. Подсказка появляется на карте у всех участников.
4. Метка автоматически исчезает через 1 час.
5. Автор метки или модератор/админ/root может удалить метку двойным нажатием.
6. В базе сохраняется информация о том, кто поставил и кто удалил метку (если применимо). 

## 1️⃣5️⃣ Поиск автомобиля по фото (распознавание номера)

_Пошаговое описание процесса:_

1. Пользователь отправляет фотографию автомобиля в Telegram-бот.
2. Бот отправляет фото на backend-эндпоинт /api/ocr.
3. Backend распознаёт номер через внешний сервис, ищет его в базе клуба.
4. Бот получает ответ с распознанным номером и статусом (есть ли такой номер в клубе, статус авто).
5. Бот сообщает пользователю:
   - Если номер найден: «Распознан номер: 0070MX7. Такой номер есть в клубе, статус авто: active.»
   - Если не найден: «Распознан номер: 0070MX7. Такого номера нет в клубе.»
6. Если номер не распознан или фото невалидно — бот сообщает об ошибке.

---

## 1️⃣6️⃣ Поиск автомобиля по текстовому номеру

_Пошаговое описание процесса:_

1. Пользователь отправляет номер автомобиля текстом в Telegram-бот.
2. Бот отправляет запрос на backend-эндпоинт /api/plate-search с этим номером (или его частью).
3. Backend ищет совпадения в базе (по частичному совпадению).
4. Бот получает ответ found: true/false.
5. Бот сообщает пользователю:
   - Если found: true — «В клубе есть авто с таким номером.»
   - Если found: false — «В клубе нет авто с таким номером.»
6. Если запрос некорректный — бот сообщает об ошибке. 

## Заполнение профиля

**Пошаговое описание процесса:**

1. После добавления автомобиля (have_auto = true) или выбора "Я без авто" (have_auto = false) пользователь автоматически попадает в раздел "Профиль".
2. На экране отображается анкета с вопросами:
   - Имя, фамилия, город, страна, фото, email, телефон, о себе, username, Instagram, дата рождения.
   - Если у пользователя есть автомобиль (have_auto = true) — блок "Добавить автомобиль" (обязателен для прогресса).
   - Если у пользователя нет автомобиля (have_auto = false) — блок "С кем катаетесь" (обязательный выбор владельца из участников, сохраняется в host_user_id).
3. Рядом с каждым вопросом — поле для ввода и подсказка, если поле не заполнено.
4. В верхней части анкеты отображается прогрессбар заполнения профиля (расчёт по весам вопросов).
5. Пользователь может заполнять поля в любом порядке.
6. После заполнения каждого поля данные сохраняются автоматически или по кнопке "Сохранить".
7. Как только заполнено более 50% анкеты (по весам), кнопка "Отправить на модерацию" становится активной.
8. Если заполнено меньше — кнопка неактивна, под прогрессбаром отображается список незаполненных обязательных полей.
9. После нажатия "Отправить на модерацию" появляется сообщение: "Ваш профиль отправлен на модерацию." Статус меняется на "pending".
10. Пользователь может продолжать редактировать профиль даже после отправки на модерацию. Если профиль был "active" и был отредактирован — статус снова становится "pending".

**UX-детали:**
- Все поля валидируются в реальном времени.
- Под незаполненными вопросами — подсказки.
- Прогрессбар всегда виден.
- После отправки — короткое сообщение и возврат к профилю.

--- 

## 5️⃣ Добавление и управление объектами (гид)

**Пошаговое описание процесса:**

1. **Переход в раздел "Гид"**
   - Пользователь открывает раздел "Гид" в приложении.
   - В правом нижнем углу экрана отображается плавающая кнопка "+" (FAB), предназначенная для добавления нового объекта.

2. **Выбор типа**
   - В начале формы обязательно спрашивается: "Что вы хотите добавить?" — тип объекта (radio/select, обязательное поле).

3. **Заполнение формы**
   - В зависимости от выбора типа отображаются соответствующие поля:
     - Название (обязательное)
     - Категория (обязательное)
     - Описание (опционально)
     - Фото/логотип (опционально)
     - Контакты (опционально)
     - Ссылка на сайт/Instagram (опционально)
   - Пользователь заполняет обязательные поля.

4. **Сохранение**
   - После заполнения формы предлагается:
     - "Сохранить" — объект сохраняется, появляется в списке, пользователь получает уведомление через Telegram-бот.
     - "Сохранить и оставить отзыв" — объект сохраняется, затем открывается форма отзыва (описание процесса отзыва — в отдельном сценарии).

5. **Просмотр и управление объектами (гид)**
   - В списке отображаются все объекты.
   - При нажатии на карточку открывается подробная информация.
   - **Редактировать** карточку может любой активный пользователь.
   - **Удалить** может только администратор (кнопка "Удалить" видна только для админов; при удалении статус меняется на 'удалён').

6. **Edge-cases**
   - Если пользователь пытается добавить дубликат — появляется подсказка.
   - Если достигнут лимит — кнопка "+" становится неактивной, появляется подсказка.
   - Все ошибки и успешные действия сопровождаются уведомлениями через Telegram-бот.
   - При удалении статус меняется на 'удалён', запись остаётся в базе.

**UX-детали:**
- Кнопка "+" (FAB) всегда в правом нижнем углу.
- После добавления/редактирования/удаления пользователь остаётся в разделе и видит актуальный список.
- После "Сохранить и оставить отзыв" открывается форма отзыва (описание — отдельно).

---

## Система respect (кристаллы)

**Respect** — это внутренняя система "кристаллов", отражающая вес и авторитет пользователя в клубе CabrioRide. Respect — это условные лайки, которые можно получать только от других участников.

#### Техническая реализация

- Значение respect хранится в поле `respect` таблицы `users` (тип: TINYINT UNSIGNED, default: 24, max: 255).
- Для контроля лимитов и истории выдачи respect используется отдельная таблица `respect_logs` со следующей структурой:
  - `id` (PK)
  - `from_user_id` — кто поставил respect (FK на users)
  - `to_user_id` — кому поставлен respect (FK на users)
  - `created_at` — дата и время постановки respect
- При попытке поставить respect система проверяет:
  - Не ставил ли пользователь respect этому участнику сегодня (по respect_logs).
  - Не превышен ли дневной лимит (по количеству записей за сегодня от данного пользователя).
- Все параметры системы respect централизованно настраиваются в файле [`config/app.config.ts`](../config/app.config.ts).

> Не забыть: подробно описать структуру и назначение конфигурационного файла в документации (docs/ENVIRONMENT.md или отдельный раздел).

### 1. Получение стартовых кристаллов
- После регистрации пользователь автоматически получает 24 кристалла respect.
- Кристаллы отображаются на карточке пользователя (иконка кристалла, цвет и округлённое значение).

### 2. Как поставить respect другому пользователю
- Пользователь может поставить respect любому другому участнику клуба (но не себе).
- На карточке участника отображается кнопка respect (иконка кристалла).
- Кнопка активна, если:
  - Это не свой профиль.
  - Сегодня respect этому участнику ещё не ставился.
  - Не превышен дневной лимит (по умолчанию — 5 респектов разным людям в сутки, значение настраивается в конфиге).
- При нажатии на кнопку:
  - У выбранного пользователя увеличивается количество respect (но не больше 255).
  - У инициатора уменьшается лимит на сегодня.
  - Кнопка становится неактивной для этого пользователя до следующего дня.
- Отозвать respect нельзя.
- Пользователь не видит, кто ему поставил respect, и не получает уведомлений.

### 3. Сгорание respect
- Каждый день в полночь у всех пользователей автоматически сгорает 2 respect (если есть).
- Если у пользователя меньше 2 respect — становится 0 (в минус не уходит).
- Respect сгорают независимо от активности пользователя.

### 4. Влияние respect
- Количество respect влияет на сортировку в списке участников (чем больше, тем выше).
- В будущем respect может влиять на вес отзывов, доступ к функциям и другие механики.

### 5. Визуализация
- На карточке пользователя отображается кристалл:
  - Цвет насыщается по мере роста respect.
  - Рядом отображается округлённое значение (например, "10+", "120+").
- Кнопка respect доступна только на чужих карточках.

### 6. Ограничения
- Себе поставить respect нельзя.
- В день можно поставить respect максимум 5 разным людям (значение настраивается в конфиге).
- Одному и тому же человеку — только 1 раз в сутки.
- Максимум respect — 255, минимум — 0.

### 7. Edge-cases
- Если пользователь достиг максимального значения respect (255), новые respect не начисляются.
- Если у пользователя 1 respect и наступает ночь — становится 0.
- Если пользователь не заходит в приложение, respect всё равно сгорают.
- Если лимит respect на день исчерпан — кнопка respect становится неактивной до следующего дня. 

## 1️⃣ Авторизация и вход через Telegram

**Кратко:**
Вход в приложение возможен только через Telegram-бота. Проверка членства в Telegram-чате обязательна на каждом этапе работы с приложением.

### Пошаговый сценарий:

1. **Вход через Telegram-бота**
   - Пользователь запускает Telegram-бота CabrioRide.
   - В боте отображается кнопка "Перейти в приложение".
   - Пользователь нажимает кнопку, переходит в WebApp.

2. **Переход в приложение**
   - Приложение получает данные пользователя от Telegram (user_id, username и т.д.).
   - Если пользователь впервые — создаётся запись в базе.

3. **Проверка членства в Telegram-чате**
   - При каждом запуске приложения и при любой активности backend проверяет, состоит ли пользователь в клубном Telegram-чате (через Telegram API).

4. **Если пользователь состоит в чате**
   - Доступ к приложению открыт, пользователь продолжает путь (см. "Первый вход" и далее).

5. **Если пользователь НЕ состоит в чате**
   - В базе создаётся (или обновляется) запись пользователя со статусом **external**.
   - Пользователь видит заглушку:
     - Сообщение: "Вы не являетесь участником Telegram-чата CabrioRide. Для доступа к приложению необходимо вступить в клубный чат."
     - Кнопка/ссылка для перехода в Telegram-чат.
   - Пользователь не может пользоваться приложением до вступления в чат.

### Edge-cases:
- Если пользователь покидает чат во время работы — при следующей активности его статус меняется на **external**, появляется заглушка.
- Если Telegram API недоступен — показывается сообщение об ошибке, просьба повторить позже.
- Если пользователь возвращается в чат — при следующей проверке его статус обновляется, доступ восстанавливается.

### UX-детали:
- Заглушка с объяснением и ссылкой на чат.
- Проверка членства происходит автоматически, без лишних действий пользователя. 

## 2️⃣ Выход из клуба (выход из Telegram-чата)

**Кратко:**
Если пользователь покидает клубный Telegram-чат, его статус в системе автоматически меняется на **left**. Доступ к приложению блокируется до повторного вступления в чат.

### Пошаговый сценарий:

1. **Пользователь выходит из клубного Telegram-чата**
   - Пользователь вручную покидает чат или его удаляет модератор/админ.

2. **Проверка членства**
   - При любой активности в приложении (или при запуске) backend проверяет, состоит ли пользователь в чате (через Telegram API).

3. **Если пользователь больше не состоит в чате**
   - В базе статус пользователя автоматически меняется на **left**.
   - Пользователь теряет доступ ко всем разделам приложения.
   - На экране появляется заглушка:
     - Сообщение: «Вы вышли из клубного Telegram-чата CabrioRide. Для восстановления доступа вступите в чат повторно.»
     - Кнопка/ссылка для перехода в Telegram-чат.

4. **Повторное вступление**
   - Если пользователь снова вступает в чат, при следующей проверке его статус обновляется, доступ восстанавливается.

### Последствия:
- Профиль и все данные пользователя сохраняются в базе (для истории и аудита).
- Все автомобили пользователя получают статус **left** (и скрываются из публичных разделов).
- Пользователь не отображается в списках участников, не может участвовать в событиях, оставлять отзывы и т.д.
- Все связанные сущности (отзывы, события) остаются в базе, но могут быть скрыты из публичных разделов.

### Edge-cases:
- Если пользователь был удалён из чата модератором — причина фиксируется в логах модерации.
- Если пользователь пытается войти с тем же Telegram-аккаунтом — видит заглушку с объяснением.
- Если Telegram API временно недоступен — показывается сообщение об ошибке.

### UX-детали:
- Заглушка с объяснением и ссылкой на чат.
- Проверка членства происходит автоматически, без лишних действий пользователя. 

---

## 🚫 Блоки и сценарии, сознательно не реализуемые на данном этапе

> В рамках текущих требований и философии CabrioRide следующие сценарии **сознательно не реализуются** и будут рассмотрены в будущем при необходимости:
>
> - Управление профилем и настройками (смена данных, Telegram, приватность, язык, тема)
> - Модерация гид-объектов (GuideObject), событий, отзывов
> - Жалобы/репорты
> - Работа с фото (загрузка, удаление, модерация, лимиты)
> - Восстановление доступа (потеря Telegram, блокировка)
> - Удаление профиля
> - Статистика и дашборд для админов
> - История действий пользователя
> - Реферальная система
>
> **Причина:** В клубе CabrioRide нет случайных людей — все участники осознанно вступают в сообщество, понимают правила и несут ответственность за свои действия. Модерация ограничена только активацией новых участников. Если кто-то добавит неприемлемый контент, это будет исключением и приведёт к быстрому бану. После активации участники считаются доверенными, и дальнейшая модерация не требуется. 

## 3️⃣ Плюс один на событиях (участие с гостем)

**Кратко:**
Пользователь может отметить, что придёт на событие с гостем (+1). Это делается через расширение кнопки "Да" в карточке события. Механика нужна только для планирования количества людей.

### Пошаговый сценарий:

1. **Выбор участия в событии**
   - В карточке события есть три кнопки: "Да", "Возможно", "Нет".
   - Кнопка "Да" имеет стрелку вниз (▼), открывающую выпадающее меню.
   - В выпадающем меню два варианта:
     - "Приду один"
     - "Приду с +1 (гость)"

2. **Отметка участия с гостем**
   - Пользователь выбирает "Приду с +1 (гость)".
   - В базе для этого пользователя и события фиксируется флаг plus_one = true.
   - В любой момент пользователь может изменить свой выбор (например, снять +1 или вернуться к "Приду один").

3. **Отображение в списке участников**
   - В списке участников события у пользователя, выбравшего +1, рядом с именем отображается иконка или текст "+1".
   - Общее количество участников события учитывает всех +1 (например, "12 участников, из них 2 с +1").
   - Организатор видит точное количество ожидаемых людей (участники + гости).

### Edge-cases:
- Пользователь может изменить свой выбор в любой момент до начала события.
- Если пользователь отменяет участие или меняет статус на "Нет" — флаг +1 сбрасывается.
- Если достигнут лимит участников, +1 может быть недоступен (по решению организатора).

### UX-детали:
- Кнопка "Да" визуально разделена: основная часть — просто "Да", стрелка — раскрывает меню.
- После выбора варианта кнопка отображает текущий выбор (например, "Да, с +1").
- В списке участников +1 отображается компактно и понятно для всех. 

## 4️⃣ Просмотр и редактирование профиля участника админом/root

**Кратко:**
При просмотре подробной (большой) карточки пользователя у админов и root появляется дополнительная секция с ролями, статусами и флагами. Админы могут изменить любой из этих параметров и сохранить изменения.

### Пошаговый сценарий:

1. **Открытие карточки пользователя**
   - Админ или root открывает подробную карточку любого участника.

2. **Появление дополнительного блока**
   - В самом низу карточки появляется отдельная секция "Роли, статусы и флаги" (видна только админам и root).
   - В секции отображаются:
     - Текущая роль пользователя (user, moderator, admin, root)
     - Текущий статус (active, pending, left, blocked, external и др.)
     - Флаги (например, block, have_auto, другие служебные флаги)
   - Все поля доступны для редактирования (select, checkbox и т.д.).

3. **Редактирование и сохранение**
   - Админ может изменить любой из параметров.
   - После внесения изменений появляется кнопка "Сохранить" (активна только если были изменения).
   - После нажатия "Сохранить":
     - Изменения отправляются на backend и сохраняются в базе.
     - Пользователь (чей профиль редактировался) получает уведомление .

### Ограничения и права:
- Блок виден только пользователям с ролью admin или root.
- Изменять можно любые параметры, кроме root-аккаунтов (root может менять только root).
- Все действия админа фиксируются в логах модерации .

### UX-детали:
- Блок всегда находится в самом низу карточки пользователя, визуально отделён от основной информации.
- Кнопка "Сохранить" появляется только при изменении данных.
- Все изменения применяются мгновенно после сохранения. 

---

## 1️⃣ Работа с Telegram-ботом: /start, проверка авто, вход в приложение

**Кратко:**
Бот CabrioRide позволяет авторизоваться в приложении, проверять автомобили по фото или номеру, а также получать уведомления. Все действия доступны только для пользователей, состоящих в клубном чате.

### Пошаговый сценарий:

1. **/start**
   - Пользователь отправляет команду /start боту.
   - Бот проверяет, состоит ли пользователь в клубном Telegram-чате.
     - Если не состоит — отправляет заглушку: «Для использования бота вступите в клубный чат CabrioRide» (ссылка на чат).
     - Если состоит — отправляет приветствие и инструкцию:
       - Кратко объясняет, что бот умеет:
         - Проверять авто по фото или номеру
         - Переводить в приложение (WebApp)
         - Присылать уведомления
       - Кнопка «Перейти в приложение» (deep-link в WebApp)

2. **Переход в приложение через бота**
   - Пользователь нажимает кнопку «Перейти в приложение» в боте.
   - Открывается WebApp CabrioRide, в который передаются данные Telegram (user_id, username и др.).
   - Если пользователь не состоит в чате — WebApp также показывает заглушку.
   - **Если WebApp не может получить данные Telegram — показывается сообщение: "Ошибка. Обратитесь к админу."**

3. **Проверка авто по фото**
   - Пользователь отправляет боту фото автомобиля.
   - Бот проверяет, состоит ли пользователь в чате.
     - Если нет — заглушка.
     - Если да — фото отправляется на backend для распознавания номера.
   - В ответ:
     - Если номер распознан:
       - Бот сообщает номер и статус (есть ли в клубе, статус авто).
       - Если у пользователя в приложении статус active — спрашивает: «Хотите оставить визитку?» (Да/Нет).
         - Если «Да» — создаётся запись визитки (и машины с использованием фото и номера, если нужно), сообщение об успехе.
         - Если «Нет» — шуточное сообщение "Ну и не надо =D ".
       - Если статус не active — просто сообщает результат проверки, про визитку не спрашивает.
      - Если номер не распознан — сообщение об ошибке, просьба попробовать снова или ввести вручную.

4. **Проверка авто по номеру (текст)**
   - Пользователь отправляет боту текст (3–8 символов, только латиница и цифры).
   - Бот проверяет, состоит ли пользователь в чате.
     - Если нет — заглушка.
     - Если да — ищет совпадения по базе:
       - Если есть совпадения — сообщение «Совпадения есть».
       - Если нет — сообщение «Совпадений нет».
     - В этом случае про визитку не спрашивает.

### Edge-cases:
- Если пользователь не состоит в чате — все функции недоступны, бот всегда отправляет заглушку.
- Если статус пользователя не active — бот не предлагает оставить визитку, только сообщает результат проверки.
- Если фото не удалось распознать — сообщение об ошибке, возможность попробовать снова или ввести вручную.
- Если превышен лимит проверок/визиток — соответствующее сообщение.
- Если Telegram API/сервер недоступен — сообщение об ошибке.

### UX-детали:
- Все сообщения и инструкции берутся из конфига bot.notifications.
- Кнопка «Перейти в приложение» всегда доступна для участников чата.
- Проверка авто по фото — только для участников чата, сразу после распознавания спрашивается про визитку.
- Проверка авто по номеру — только поиск, без визитки.

### Лимиты/ограничения:
- Все лимиты (проверки, визитки) — в config/app.config.ts
- Только для пользователей, состоящих в клубном чате

### Связанные статусы/роли:
- Пользователь: только со статусом active (член чата)

### Ссылки на другие документы:
- [Конфиг уведомлений бота](../config/bot.config.ts)
- [Лимиты и параметры](../config/app.config.ts)
- [API: /api/ocr, /api/plate-search](API_METHODS.md)
- [Добавление визитки (user flow)](#5️⃣-добавление-визитки-приглашение-нового-участника-через-приложение)

---

# 📲 Список всех необходимых уведомлений CabrioRide

## Личные уведомления пользователю (бот в личку)

- **Регистрация и модерация**
  - Профиль отправлен на модерацию
  - Профиль одобрен
  - Профиль отклонён (с указанием причины)
  - Профиль заблокирован (с указанием причины)
  - Профиль возвращён на доработку
- **Автомобили**
  - Автомобиль успешно добавлен
  - Автомобиль отредактирован
  - Автомобиль удалён (статус 'удалён')
  - Визитка оставлена (опционально)
- **События**
  - Событие успешно добавлено
  - Событие отредактировано
  - Событие удалено (статус 'удалён')
  - Изменение статуса участия (например, уведомление организатору)
- **Отзывы**
  - Отзыв успешно добавлен
  - Отзыв отредактирован
  - Отзыв удалён
- **Respect**
  - Получен respect
  - Достигнут лимит respect на сегодня
- **Визитки**
  - Визитка успешно оставлена
  - Ошибка при отправке визитки (не хватает данных, превышен лимит)
- **Ошибки и лимиты**
  - Превышен лимит проверок авто/визиток
  - Ошибка распознавания фото
  - Ошибка WebApp (нет данных Telegram)
- **Системные**
  - Изменение роли/статуса
  - Выход из клуба (left/external)

---

## Групповые уведомления (бот в чат клуба)

- **Приветствие новых участников**
  - Welcome message (новый пользователь вступил в чат)
- **Новые автомобили**
  - Новое авто в клубе
- **Новые события**
  - Новое событие
- **Гид-объекты (GuideObject)**
  - Добавлен новый гид-объект (GuideObject)
- **Визитки**
  - Оставлена визитка (опционально)

---

## Где уведомлять

- **Пользователь** — всегда получает личные уведомления о своих действиях, статусах, ошибках, лимитах, модерации, respect, визитках, событиях, отзывах.
- **Групповой чат** — уведомления о новых участниках, новых авто, новых событиях, приветствия, (опционально) о визитках и достижениях respect.

---

> Все шаблоны уведомлений и их включение/выключение настраиваются в [config/bot.config.ts](../config/bot.config.ts)